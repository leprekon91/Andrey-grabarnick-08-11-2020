(this.webpackJsonpview=this.webpackJsonpview||[]).push([[0],{120:function(e,t,n){},150:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),r=n.n(c),i=n(13),o=n.n(i),s=n(26),j=n(15),u=n(214),l=n(99),b=n.n(l),d=(n(120),n(121),n(12)),O=n(32),h=n.n(O),x=n(40),m=n(7),p=n(14),g=n.n(p),f=n(203),v=n(216),S=n(101),y=n(193),w=n(204),C=n(192),k=n(217),I=n(11),N=n(189),W=n(30),F=Object(N.a)((function(e){return{mainFeaturedPost:{position:"relative",height:"50vh",backgroundColor:e.palette.grey[800],color:e.palette.common.white,marginBottom:e.spacing(4),backgroundImage:"url(/icons/home_bg.jpg)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.5)"},mainFeaturedPostContent:Object(I.a)({position:"relative",padding:e.spacing(3)},e.breakpoints.up("md"),{padding:e.spacing(6),paddingRight:0})}}));var D=function(){var e=F();return Object(a.jsx)(v.a,{m:2,children:Object(a.jsxs)(S.a,{className:e.mainFeaturedPost,children:[Object(a.jsx)("img",{style:{display:"none"},src:"/icons/home_bg.jpg",alt:"home bg"}),Object(a.jsx)("div",{className:e.overlay}),Object(a.jsx)(C.a,{container:!0,children:Object(a.jsx)(C.a,{item:!0,md:6,children:Object(a.jsxs)("div",{className:e.mainFeaturedPostContent,children:[Object(a.jsx)(W.a,{component:"h1",variant:"h3",color:"inherit",gutterBottom:!0,children:"Welcome to Gaggle"}),Object(a.jsx)(W.a,{variant:"h5",color:"inherit",paragraph:!0,children:"The E-mail-like app you never asked for."})]})})})]})})},E=n(215);var q=function(e){var t=e.query,n=e.setQuery;return Object(a.jsx)(E.a,{id:"query",label:"Search by e-mail",value:t,onChange:function(e){return n(e.target.value)},variant:"outlined",fullWidth:!0,size:"medium"})},P=n(195),L=n(196),A=n(197),U=n(92),z=n.n(U),B=n(93),G=n.n(B),M=n(94),_=n.n(M),R=n(202),T=n(219),J=n(201),Q=n(199),Y=n(200),H=n(198),V=n(194),K=n(91),X=n.n(K);var Z=function(e){var t=e.msgId,n=e.onDelete;return Object(a.jsx)(V.a,{"aria-label":"delete message",onClick:function(){confirm("Are you sure? this can not be undone!")&&g.a.post("/api/delete",{message_id:t}).then((function(){alert("Message deleted!"),n()}))},children:Object(a.jsx)(X.a,{color:"secondary"})})};function $(e){var t=e.message,n=e.type,i=e.onUpdate,o=Object(c.useState)(!1),s=Object(m.a)(o,2),j=s[0],u=s[1],l=t.id,b=t.title,d=t.sender,O=t.receiver,h=t.received,x=t.seen,p=t.body,f=t.sentAt;r.a.useEffect((function(){h||"inbox"!==n||g.a.post("/api/receive",{message_id:l})}),[]);var v=Object(a.jsx)(z.a,{color:"action"});h&&(v=Object(a.jsx)(G.a,{color:"secondary"})),x&&(v=Object(a.jsx)(_.a,{color:"primary"}));return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(P.a,{button:!0,onClick:function(){u(!0),"inbox"===n&&g.a.post("/api/see",{message_id:l}).catch(alert)},children:[Object(a.jsx)(L.a,{children:v}),Object(a.jsx)(A.a,{primary:b,secondary:"inbox"===n?"from:".concat(d):"to:".concat(O)})]}),Object(a.jsxs)(T.a,{open:j,onClose:function(){return u(!1)},"aria-labelledby":"",children:[Object(a.jsxs)(H.a,{id:"",children:[b," - ",new Date(f).toLocaleString()]}),Object(a.jsx)(Q.a,{children:Object(a.jsxs)(Y.a,{children:["inbox"===n?"from:".concat(d):"to:".concat(O),Object(a.jsx)("br",{}),p]})}),Object(a.jsxs)(J.a,{children:["inbox"===n&&Object(a.jsx)(Z,{msgId:l,onDelete:function(){u(!1),i()}}),Object(a.jsx)(R.a,{onClick:function(){return u(!1)},color:"default",children:"Close"})]})]})]})}$.defaultProps={onUpdate:function(){}};var ee=$;var te=function(){var e=Object(c.useState)(!1),t=Object(m.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(!1),o=Object(m.a)(i,2),s=o[0],j=o[1],u=Object(c.useState)(""),l=Object(m.a)(u,2),b=l[0],O=l[1],p=Object(c.useState)([]),I=Object(m.a)(p,2),N=I[0],W=I[1],F=Object(c.useState)(1),E=Object(m.a)(F,2),P=E[0],L=E[1],A=Object(c.useState)(1),U=Object(m.a)(A,2),z=U[0],B=U[1],G=Object(c.useState)(""),M=Object(m.a)(G,2),_=M[0],R=M[1];return Object(c.useEffect)(Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(!0),g()("/api/me").then((function(e){j(!1),r(e.data.isLoggedIn),e.data.isLoggedIn&&R(e.data.email)})).catch();case 2:case"end":return e.stop()}}),e)}))),[n]),Object(c.useEffect)((function(){n&&g.a.get("/api/getall/".concat(P,"/").concat(""===b?"none":b)).then((function(e){var t=e.data.data;t.sort((function(e,t){return new Date(e.sentAt)>new Date(t.sentAt)?1:-1})),W(Object(d.a)(t)),B(e.data.pages)})).catch(alert)}),[b,n]),s?Object(a.jsx)(f.a,{}):n?Object(a.jsxs)(v.a,{m:1,children:[Object(a.jsx)(q,{query:b,setQuery:O}),Object(a.jsxs)(S.a,{children:[Object(a.jsx)(y.a,{children:N.map((function(e){return Object(a.jsx)(ee,{message:e,type:e.receiver===_?"inbox":"sent"},e.id)}))}),Object(a.jsx)(w.a,{}),z>1&&Object(a.jsx)(C.a,{container:!0,direction:"row",justify:"center",children:Object(a.jsx)(k.a,{count:z,page:P,onChange:function(e,t){return L(t)}})})]})]}):Object(a.jsx)(D,{})};var ne=function(){return Object(a.jsxs)(C.a,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",children:[Object(a.jsx)(W.a,{variant:"h1",color:"primary",children:"No Messages Here!"}),Object(a.jsxs)(W.a,{variant:"h4",color:"default",children:["Send a messsage through the ",Object(a.jsx)("i",{children:"Compose"})," button on the bottom!"]})]})};var ae=function(){var e=Object(c.useState)([]),t=Object(m.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(1),o=Object(m.a)(i,2),s=o[0],j=o[1],u=Object(c.useState)(1),l=Object(m.a)(u,2),b=l[0],O=l[1];return Object(c.useEffect)((function(){g.a.get("/api/getinbox/".concat(s)).then((function(e){var t=e.data.data;t.sort((function(e,t){return new Date(e.sentAt)>new Date(t.sentAt)?1:-1})),r(Object(d.a)(t)),O(e.data.pages)})).catch(alert)}),[s]),0===n.length?Object(a.jsx)(ne,{}):Object(a.jsxs)(v.a,{m:1,children:[Object(a.jsx)(W.a,{variant:"h4",color:"initial",children:"Inbox"}),Object(a.jsx)(w.a,{}),Object(a.jsx)("br",{}),Object(a.jsxs)(S.a,{children:[Object(a.jsx)(y.a,{children:n.map((function(e){return Object(a.jsx)(ee,{message:e,type:"inbox",onUpdate:function(){var t=n.indexOf((function(t){return t.id===e.id}));n.splice(t,1)}},e.id)}))}),Object(a.jsx)(w.a,{}),b>1&&Object(a.jsx)(C.a,{container:!0,direction:"row",justify:"center",children:Object(a.jsx)(k.a,{count:b,page:s,onChange:function(e,t){return j(t)}})})]}),Object(a.jsx)("br",{})]})};var ce=function(){var e=Object(c.useState)([]),t=Object(m.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(1),o=Object(m.a)(i,2),s=o[0],j=o[1],u=Object(c.useState)(1),l=Object(m.a)(u,2),b=l[0],O=l[1];return Object(c.useEffect)((function(){g.a.get("/api/getsent/".concat(s)).then((function(e){var t=e.data.data;r(Object(d.a)(t)),O(e.data.pages)})).catch(alert)}),[s,n.length]),0===n.length?Object(a.jsx)(ne,{}):Object(a.jsxs)(v.a,{m:1,children:[Object(a.jsx)(W.a,{variant:"h4",color:"initial",children:"Sent"}),Object(a.jsx)(w.a,{}),Object(a.jsx)("br",{}),Object(a.jsxs)(S.a,{children:[Object(a.jsx)(y.a,{children:n.map((function(e){return Object(a.jsx)(ee,{message:e,type:"sent"},e.id)}))}),Object(a.jsx)(w.a,{}),b>1&&Object(a.jsx)(C.a,{container:!0,direction:"row",justify:"center",children:Object(a.jsx)(k.a,{count:b,page:s,onChange:function(e,t){return j(t)}})})]}),Object(a.jsx)("br",{})]})},re=n(208),ie=n(209),oe=n(98),se=n.n(oe),je=n(62),ue=n.n(je),le=n(95),be=n.n(le);var de=function(e){var t=e.logout,n=r.a.useState(!1),c=Object(m.a)(n,2),i=c[0],o=c[1];return i?Object(a.jsx)(j.a,{to:"/"}):Object(a.jsx)(R.a,{color:"inherit",onClick:function(e){e.preventDefault(),g()("/api/logout").then((function(){o(!0),t()}))},startIcon:Object(a.jsx)(be.a,{}),children:"Signout"})},Oe=n(97),he=n.n(Oe),xe=n(220),me=n(206),pe=n(96),ge=n.n(pe),fe=n(205),ve=n(207);var Se=function(){return Object(a.jsxs)(W.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ","Gaggle\xa0",(new Date).getFullYear(),"."]})},ye=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function we(e){var t=e.onLogin,n=ye(),r=Object(c.useState)(!1),i=Object(m.a)(r,2),o=i[0],s=i[1],u=Object(c.useState)(""),l=Object(m.a)(u,2),b=l[0],d=l[1],O=Object(c.useState)(""),h=Object(m.a)(O,2),x=h[0],p=h[1],f=Object(c.useState)(!1),S=Object(m.a)(f,2),y=S[0],w=S[1],C=Object(c.useState)(""),k=Object(m.a)(C,2),I=k[0],N=k[1];return y?Object(a.jsx)(j.a,{to:"/inbox"}):Object(a.jsxs)(fe.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(me.a,{}),Object(a.jsxs)("div",{className:n.paper,children:[Object(a.jsx)(xe.a,{className:n.avatar,children:Object(a.jsx)(ge.a,{})}),Object(a.jsx)(W.a,{component:"h1",variant:"h5",children:"Sign In"}),Object(a.jsxs)("form",{className:n.form,onSubmit:function(e){e.preventDefault(),s(!0),g.a.post("/api/login",{username:b,password:x}).then((function(){s(!1),w(!0),t()})).catch((function(){s(!1),N("Login failed!")}))},noValidate:!0,children:[Object(a.jsx)(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"User Name",name:"username",autoComplete:"username",value:b,onChange:function(e){return d(e.target.value)},autoFocus:!0}),Object(a.jsx)(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:x,onChange:function(e){return p(e.target.value)}}),Object(a.jsx)(W.a,{variant:"body1",color:"error",children:I}),Object(a.jsx)(R.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,children:o?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(ve.a,{size:24,color:"inherit"})}):"Sign In"})]})]}),Object(a.jsx)(v.a,{mt:8,children:Object(a.jsx)(Se,{})})]})}we.defaultProps={onLogin:function(){}};var Ce=function(e){var t=e.onLogin,n=r.a.useState(!1),c=Object(m.a)(n,2),i=c[0],o=c[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(R.a,{color:"inherit",onClick:function(){return o(!0)},startIcon:Object(a.jsx)(he.a,{}),children:"Sign in"}),Object(a.jsx)(T.a,{open:i,onClose:function(){return o(!1)},children:Object(a.jsx)(Q.a,{children:Object(a.jsx)(we,{onLogin:t})})})]})},ke=n(61),Ie=n.n(ke);function Ne(e){var t=e.onSignup,n=ye(),r=Object(c.useState)(!1),i=Object(m.a)(r,2),o=i[0],s=i[1],u=Object(c.useState)(""),l=Object(m.a)(u,2),b=l[0],d=l[1],O=Object(c.useState)(""),h=Object(m.a)(O,2),x=h[0],p=h[1],f=Object(c.useState)(""),S=Object(m.a)(f,2),y=S[0],w=S[1],C=Object(c.useState)(""),k=Object(m.a)(C,2),I=k[0],N=k[1],F=Object(c.useState)(!1),D=Object(m.a)(F,2),q=D[0],P=D[1],L=Object(c.useState)(""),A=Object(m.a)(L,2),U=A[0],z=A[1];return q?Object(a.jsx)(j.a,{to:"/"}):Object(a.jsxs)(fe.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(me.a,{}),Object(a.jsxs)("div",{className:n.paper,children:[Object(a.jsx)(xe.a,{className:n.avatar,children:Object(a.jsx)(Ie.a,{})}),Object(a.jsx)(W.a,{component:"h1",variant:"h5",children:"Sign Up"}),Object(a.jsxs)("form",{className:n.form,onSubmit:function(e){e.preventDefault(),s(!0),g.a.post("/api/signup",{username:b,password:x,email:I}).then((function(){s(!1),P(!0),t()})).catch((function(e){console.log(e),s(!1),z("Signup failed. You probably already have a user with that email...")}))},children:[Object(a.jsx)(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"User Name",name:"username",autoComplete:"username",value:b,onChange:function(e){return d(e.target.value)},autoFocus:!0}),Object(a.jsx)(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"E-mail",name:"email",autoComplete:"email",value:I,onChange:function(e){return N(e.target.value)}}),Object(a.jsx)(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:x,onChange:function(e){return p(e.target.value)}}),Object(a.jsx)(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"confirm",label:"Confirm Password",type:"password",id:"confirm",autoComplete:"current-password",value:y,onChange:function(e){return w(e.target.value)}}),Object(a.jsx)(W.a,{variant:"body1",color:"error",children:U}),Object(a.jsx)(R.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:n.submit,children:o?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(ve.a,{size:24,color:"inherit"})}):"Sign Up"})]})]}),Object(a.jsx)(v.a,{mt:8,children:Object(a.jsx)(Se,{})})]})}Ne.defaultProps={onSignup:function(){}};var We=Ne;var Fe=function(e){var t=e.onSignup,n=r.a.useState(!1),c=Object(m.a)(n,2),i=c[0],o=c[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(R.a,{color:"inherit",onClick:function(){return o(!0)},startIcon:Object(a.jsx)(Ie.a,{}),children:"Sign up"}),Object(a.jsx)(T.a,{open:i,onClose:function(){return o(!1)},children:Object(a.jsx)(Q.a,{children:Object(a.jsx)(We,{onSignup:t})})})]})},De=Object(N.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function Ee(){var e=De(),t=r.a.useState(!1),n=Object(m.a)(t,2),c=n[0],i=n[1];return r.a.useEffect(Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g()("/api/me").then((function(e){return i(e.data.isLoggedIn)}));case 1:case"end":return e.stop()}}),e)})))),Object(a.jsx)("div",{className:e.root,children:Object(a.jsx)(re.a,{position:"static",children:Object(a.jsxs)(ie.a,{children:[Object(a.jsx)(V.a,{edge:"start",className:e.menuButton,component:s.b,to:"/",color:"inherit","aria-label":"menu",children:Object(a.jsx)("img",{src:"/icons/chicken.png",alt:"logo",height:30,width:30})}),Object(a.jsx)(W.a,{variant:"h6",className:e.title,children:"Gaggle"}),c?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(R.a,{color:"inherit",component:s.b,to:"/inbox",startIcon:Object(a.jsx)(se.a,{}),children:"Inbox"}),Object(a.jsx)(R.a,{color:"inherit",component:s.b,to:"/sent",startIcon:Object(a.jsx)(ue.a,{}),children:"Sent"}),Object(a.jsx)(de,{logout:function(){i(!1)}})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Ce,{onLogin:function(){return i(!0)}}),Object(a.jsx)(Fe,{onSignup:function(){return i(!0)}})]})]})})})}var qe=n(69);function Pe(e){var t=e.component,n=e.exact,c=e.path,i=r.a.useState(!1),o=Object(m.a)(i,2),s=o[0],u=o[1],l=r.a.useState(!0),b=Object(m.a)(l,2),d=b[0],O=b[1];return r.a.useEffect(Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g()("/api/me");case 2:t=e.sent,u(t.data.isLoggedIn),O(!t);case 5:case"end":return e.stop()}}),e)}))),[]),d?"loading":Object(a.jsx)(j.b,{exact:n,path:c,component:function(e){return s?r.a.createElement(t,Object(qe.a)(Object(qe.a)({},e),{},{logginIn:d,authenticated:s})):Object(a.jsx)(j.a,{to:"/login"})}})}Pe.defaultProps={exact:!1};var Le=Pe,Ae=n(210),Ue=n(211),ze=n(213),Be=n(212);var Ge=function(){var e=Object(c.useState)(""),t=Object(m.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(""),o=Object(m.a)(i,2),s=o[0],j=o[1],u=Object(c.useState)(""),l=Object(m.a)(u,2),b=l[0],d=l[1],O=Object(c.useState)(!1),h=Object(m.a)(O,2),x=h[0],p=h[1];return Object(a.jsx)(v.a,{m:1,children:Object(a.jsxs)(Ae.a,{children:[Object(a.jsx)(Ue.a,{title:"New Message"}),Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p(!0),g.a.post("/api/send",{toEmail:n,title:b,body:s,sentAt:(new Date).toISOString()}).then((function(){p(!1),alert("Message sent!"),r(""),d(""),j("")})).catch((function(){p(!1),alert("Error sending message!")}))},children:[Object(a.jsx)(Be.a,{children:Object(a.jsxs)(C.a,{container:!0,direction:"column",children:[Object(a.jsx)(E.a,{label:"to:",type:"email",fullWidth:!0,required:!0,value:n,onChange:function(e){return r(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)(E.a,{label:"Title",fullWidth:!0,required:!0,value:b,onChange:function(e){return d(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)(E.a,{label:"Body",variant:"outlined",fullWidth:!0,required:!0,multiline:!0,rows:10,value:s,onChange:function(e){return j(e.target.value)}})]})}),Object(a.jsx)(ze.a,{children:Object(a.jsx)(R.a,{variant:"contained",size:"large",type:"submit",color:"primary",startIcon:Object(a.jsx)(ue.a,{}),fullWidth:!0,children:x?Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(ve.a,{size:24,color:"inherit"})}):"Send"})})]})]})})};function Me(){return Object(a.jsx)("div",{children:Object(a.jsx)(s.a,{children:Object(a.jsxs)("div",{children:[Object(a.jsx)(Ee,{}),Object(a.jsxs)(u.a,{variant:"extended",style:{position:"absolute",bottom:16,right:16},color:"secondary",component:s.b,to:"/compose",children:[Object(a.jsx)(b.a,{style:{marginRight:8}}),"Compose"]}),Object(a.jsxs)(j.d,{children:[Object(a.jsx)(j.b,{path:"/",exact:!0,children:Object(a.jsx)(te,{})}),Object(a.jsx)(Le,{path:"/inbox",component:function(){return Object(a.jsx)(ae,{})}}),Object(a.jsx)(Le,{path:"/sent",component:function(){return Object(a.jsx)(ce,{})}}),Object(a.jsx)(Le,{path:"/compose",component:function(){return Object(a.jsx)(Ge,{})}}),Object(a.jsx)(j.b,{path:"/login",children:Object(a.jsx)(we,{})}),Object(a.jsx)(j.b,{path:"/signup",children:Object(a.jsx)(We,{})})]})]})})})}o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(Me,{})}),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.1ebf9622.chunk.js.map